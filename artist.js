jQuery(document).ready(function($){$('.sub').hide();$('.album_quips .quips').click(function(){$('.sub:visible').not($(this).next()).slideUp(400);$(this).next().slideToggle(400);return false;})});$().ready(function(){var $scrollingDiv=$('#sidebar');$(window).scroll(function(){$scrollingDiv.stop().animate({'marginTop':($(window).scrollTop())},'slow');});});$(document).ready(function(){$('.autosuggest').keyup(function(){var search_term=$(this).attr('value');$.post('ajax/search.php',{search_term:search_term},function(data){$('.result').html(data);$('.result li').click(function(){var result_value=$(this).text();$('.autosuggest').attr('value',result_value);$('.result').html('');});});});});var ivotings=[];var ar_elm=[];var i_elm=0;var itemvotin='';var voting_mp='/voting_mp/';var advote=0;var getVotsElm=function(){var obj_div=document.querySelectorAll('.vot_mp1, .vot_mp2, .vot_plus');for(var i=0;i<obj_div.length;i++){var elm_id=obj_div[i].getAttribute('data-vote_id');if(elm_id){ivotings[elm_id]=obj_div[i];ar_elm[i_elm]=elm_id;i_elm++;}}if(ar_elm.length>0)votAjax(ar_elm,'');};function addVotData(elm_id,v_plus,v_minus,voted){var vote=v_plus-v_minus;var nvotes=v_plus+v_minus;if(ivotings[elm_id]){var clik_down=(voted==0)?' onclick="addVote(this, -1)"':' onclick="alert(\'You already voted\')"';var clik_up=(voted==0)?' onclick="addVote(this, 1)"':' onclick="alert(\'You already voted\')"';if(ivotings[elm_id].className=='vot_plus'){ivotings[elm_id].innerHTML='<h4>'+vote+'</h4><div class="vot_plus"'+clik_up+'>&nbsp;</div>';}else if(ivotings[elm_id].className=='vot_mp1'){ivotings[elm_id].innerHTML='<div class="nvotes">Votes: <b>'+nvotes+'</b></div><h4>'+vote+'</h4><div class="v_plus"'+clik_up+'> &nbsp;</div><div class="v_minus"'+clik_down+'> &nbsp;</div>';}else if(ivotings[elm_id].className=='vot_mp2'){ivotings[elm_id].innerHTML='<h4>'+vote+'</h4><div class="vot_pm v_plus"'+clik_up+'>'+v_plus+'</div><div class="v_minus"'+clik_down+'>'+v_minus+'</div>';}}}function addVote(ivot,vote){if(advote==0){var elm=[];elm[0]=ivot.parentNode.getAttribute('data-vote_id');ivot.parentNode.innerHTML='<span class="sbi">Thanks</span>';votAjax(elm,vote);}else alert('You already voted');}function votAjax(elm,vote){var reqob=window.XMLHttpRequest?new XMLHttpRequest():new ActiveXObject('Microsoft.XMLHTTP');var datasend=[];for(var i=0;i<elm.length;i++)datasend[i]='elm[]='+elm[i];datasend=datasend.join('&')+'&vote='+vote;reqob.open('POST',voting_mp+'voting.php',true);reqob.setRequestHeader('Content-type','application/x-www-form-urlencoded');reqob.send(datasend);reqob.onreadystatechange=function(){if(reqob.readyState==4){var vot_data=JSON.parse(reqob.responseText);if(vot_data){for(var elm_id in vot_data){var voted=vot_data[elm_id].voted;if(voted==3){alert('You already voted \n You can vote again tomorrow');window.location.reload(true);}else addVotData(elm_id,vot_data[elm_id].v_plus,vot_data[elm_id].v_minus,voted);}}if(vote!=''&&(voted==undefined||voted==2))advote=1;}}}window.addEventListener('load',getVotsElm);